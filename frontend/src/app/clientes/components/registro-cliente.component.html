<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro de Estacionamiento - Cool Design</title>
    <link rel="stylesheet" href="registro-cliente.component.css"> 
</head>

<body>
    <div class="app-container">
        <div class="registration-card">
            
            <aside class="sidebar-steps">
                <div class="logo">PARKING APP</div>
                <div class="title">Crea tu Cuenta de Estacionamiento</div>
                
                <nav class="steps-nav">
                    <div class="step-item" [class.active]="paso === 'credenciales'">
                        <div class="step-icon">1</div>
                        <div class="step-text">Credenciales de Acceso</div>
                    </div>
                    <div class="step-item" [class.active]="paso === 'datos_personales'">
                        <div class="step-icon">2</div>
                        <div class="step-text">Datos Personales</div>
                    </div>
                    <div class="step-item" [class.active]="paso === 'contacto_ubicacion'">
                        <div class="step-icon">3</div>
                        <div class="step-text">Contacto y Ubicación</div>
                    </div>
                    <div class="step-item" [class.active]="paso === 'confirmacion'">
                        <div class="step-icon">4</div>
                        <div class="step-text">Resumen y Confirmación</div>
                    </div>
                </nav>
            </aside>

            <main class="form-content">

                @if (errorMensaje && paso !== 'cargando') {
                <div class="error-alert">
                    <p>{{ errorMensaje }}</p>
                </div>
                }

                @if (paso === 'credenciales') {
                <form class="step-form">
                    <h2>Tus Credenciales de Acceso</h2>
                    <p class="subtitle">Establece tu nombre de usuario y contraseña.</p>

                    <div class="form-grid">
                        <div class="form-group full-width">
                            <label for="usuario">Usuario</label>
                            <input type="text" id="usuario" name="usuario" [(ngModel)]="nuevoCliente.usuario" required [disabled]="estaEditando" placeholder="Define un nombre de usuario es único">
                        </div>

                        <div class="form-group full-width">
                            <label for="email">Correo Electrónico</label>
                            <input type="email" id="email" name="email" [(ngModel)]="nuevoCliente.email" required placeholder="(ejemplo@est.ucab.edu.ve o ejemplo@ucab.edu.ve*) si es ucabista o (ejemplo@gmail.com, ejemplo@hotmail.com) si es Visitante">
                        </div>

                        <div class="form-group half-width">
                            <label for="contrasena">Contraseña</label>
                            <input type="password" id="contrasena" name="contrasena" [(ngModel)]="nuevoCliente.contrasena" required placeholder="Mínimo 8 caracteres, una mayuscula y un número">
                        </div>

                        <div class="form-group half-width">
                            <label for="confirmarContrasena">Confirmar Contraseña</label>
                            <input type="password" id="confirmarContrasena" name="confirmarContrasena" [(ngModel)]="nuevoCliente.confirmarcontrasena" required placeholder="Repite la contraseña">
                        </div>
                    </div>

                    <div class="actions">
                        <button type="button" (click)="siguientepaso()" class="btn btn-primary">
                            Continuar
                        </button>
                    </div>
                </form>
                }

                @if (paso === 'datos_personales') {
                <form class="step-form">
                    <h2>Datos Personales</h2>
                    <p class="subtitle">Necesitamos tu información básica para el registro.</p>
                    
                    <div class="form-grid">
                        <div class="form-group full-width">
                            <label for="cedula">Cédula / Identificación</label>
                            <input type="text" id="cedula" name="cedula" [(ngModel)]="nuevoCliente.cedula" required placeholder="V-00000000 o E-000000000">
                        </div>

                        <div class="form-group half-width">
                            <label for="nombre">Nombre</label>
                            <input type="text" id="nombre" name="nombre" [(ngModel)]="nuevoCliente.nombre" required placeholder="Yajaira Magaly" >
                        </div>

                        <div class="form-group half-width">
                            <label for="apellido">Apellido</label>
                            <input type="text" id="apellido" name="apellido" [(ngModel)]="nuevoCliente.apellido" required placeholder="Salazar Briceño">
                        </div>
                        
                        <div class="form-group full-width">
                            <label for="tipoPersona">Tipo de Persona</label>
                            <select id="tipoPersona" name="tipoPersona" [(ngModel)]="nuevoCliente.tipoPersona" required>
                                <option value="" disabled selected>-- Seleccione su tipo --</option>
                                <option value="UCAB"> Estudiante UCAB o Personal UCAB</option>
                                <option value="VISITANTE">Visitante Frecuente</option>
                            </select>
                        </div>
                    </div>

                    <div class="actions">
                        <button type="button" (click)="pasoAnterior()" class="btn btn-secondary">Regresar</button>
                        <button type="button" (click)="siguientepaso()" class="btn btn-primary">Continuar</button>
                    </div>
                </form>
                }
                
                @if (paso === 'contacto_ubicacion') {
                <form class="step-form">
                    <h2> Contacto y Ubicación </h2>
                    <p class="subtitle">Proporciona tu número de contacto y direccion.</p>
                    
                    <div class="form-grid">
                        <div class="form-group half-width">
                            <label for="telefono">Teléfono</label>
                            <input type="text" id="telefono" name="telefono" [(ngModel)]="nuevoCliente.telefono" required placeholder="(0212, 0416, 0424, 0426)-XXXXXXX">
                        </div>
                    
                        
                        <div class="form-group full-width">
                            <label for="direccion_secundaria">Dirección de Residencia (Opcional)</label>
                            <input type="text" id="direccion_secundaria" name="direccion_secundaria" placeholder="Calle, ciudad, estado">
                        </div>
                    </div>

                    <div class="actions">
                        <button type="button" (click)="pasoAnterior()" class="btn btn-secondary">Regresar</button>
                        <button type="button" (click)="onSubmit()" class="btn btn-primary">Registrar</button>
                    </div>
                </form>
                }

                @if (paso === 'confirmacion' && clienteConfirmado) {
                <div class="step-form confirmation-card">
                    <h2>✅ Datos Registrados Correctamente</h2>
                    <p class="subtitle">¡El sistema ha registrado su información! Por favor, confirme los siguientes detalles antes de finalizar:</p>

                    <div class="data-summary">
                        <div class="data-row"><strong>Tipo de Persona:</strong> <span>{{ clienteConfirmado.tipoPersona }}</span></div>
                        <div class="data-row"><strong>Cédula:</strong> <span>{{ clienteConfirmado.cedula }}</span></div>
                        <div class="data-row"><strong>Nombre:</strong> <span>{{ clienteConfirmado.nombre }} {{ clienteConfirmado.apellido }}</span></div>
                        <div class="data-row"><strong>Email:</strong> <span>{{ clienteConfirmado.email }}</span></div>
                        <div class="data-row"><strong>Usuario:</strong> <span>{{ clienteConfirmado.usuario }}</span></div>
                        <div class="data-row"><strong>Teléfono:</strong> <span>{{ clienteConfirmado.telefono }}</span></div>
                    </div>

                    <div class="actions">
                        <button (click)="modificarDatos()" class="btn btn-secondary">
                            Modificar Datos
                        </button>
                        <button (click)="finalizarRegistro()" class="btn btn-primary">
                            Finalizar Registro
                        </button>
                    </div>
                </div>
                }

                @if (paso === 'cargando') {
                <div class="step-form loading-screen">
                    <h2> Procesando su Registro </h2>
                    <div class="spinner"></div>
                    <p class="subtitle">Aplicando validaciones de unicidad y formato. Espere la confirmación del servidor</p>
                </div>
                }


            </main>

        </div>
    </div>
</body>
</html>