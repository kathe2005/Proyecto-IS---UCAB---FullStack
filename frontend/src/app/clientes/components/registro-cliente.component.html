<div class="main-container">


<h1> Registro de Estacionamiento </h1>

    <!-- MENSAJE DE ERROR GLOBAL -->
    @if (errorMensaje) {
            <div class="error-alert">
                <p>{{ errorMensaje }}</p>
            </div>
    }

    @if (paso === 'credenciales') 
    {   

    <div class="registro-cliente">
        <h2> Paso 1 de 3: Credenciales de Acceso  </h2>

            <fieldset>
                <legend> Credenciales de Acceso </legend>
                
                <div class="form-group">
                    <label for="usuario"> Usuario </label>
                    <input type="text" id="usuario" name="usuario" [(ngModel)] ="nuevoCliente.usuario" required>
                </div>
            

                <div class="form-group">
                    <label for="email"> Correo </label>
                    <input type="email" id="email" name="email" [(ngModel)] ="nuevoCliente.email" required>
                </div>

                
                <div class="form-group">
                    <label for="contrasena"> Contraseña </label>
                    <input type="password" id="contrasena" name="contrasena" [(ngModel)] ="nuevoCliente.contrasena" required>
                </div>

                
                <div class="form-group">
                    <label for="confirmcontrasena"> Confrimar Contraseña </label>
                    <input type="password" id="confirmcontrasena" name="confirmcontrasena" [(ngModel)] ="nuevoCliente.confirmarcontrasena" required>
                </div>
            
            </fieldset>


            <div class="actions">
                <button type="button" class=" btn btn-primary" (click)="siguientepaso()"> 
                    Continuar (Paso 2)
                </button>
            </div>
    </div>

    }

    @if (paso === 'datos_personales') 
    {   
        <div class="registro-cliente">
            <h2> Paso 2 de 3: Datos Personales  </h2>

                <fieldset>

                    <legend> Datos Personales </legend>

                    <div class="form-group">
                        <label for="cedula"> Cedula </label>
                        <input type="text" id="cedula" name="cedula" [(ngModel)] ="nuevoCliente.cedula" required>
                    </div>

                    <div class="form-group">
                        <label for="nombre"> Nombre  </label>
                        <input type="text" id="nombre" name="nombre" [(ngModel)] ="nuevoCliente.nombre" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="apellido"> Apellido </label>
                        <input type="text" id="apellido" name="apellido" [(ngModel)] ="nuevoCliente.apellido" required>
                    </div>

                    <div class="form-group">
                        <label for="tipoPersona"> Tipo de Persona </label>
                        <select id="tipoPersona" name="tipoPersona" [(ngModel)]="nuevoCliente.tipoPersona" required>
                            <option value="" disabled selected>Seleccione</option> 
                            <option value="UCAB">UCAB</option>
                            <option value="VISITANTE">VISITANTE</option>
                        </select>
                    </div>
                    
                </fieldset>

            <div class="actions">
    <           <button type="button" class=" btn btn-primary" (click)="siguientepaso()"> 
                    Continuar (Paso 2)
                </button>
            </div>

            <div class="actions">
                <button (click)="pasoAnterior()" class=" btn btn-primary">
                    Regresar
                </button>
            </div>


        </div> 
    }

        
    @if (paso === 'contacto_ubicacion') 
    {   
        <div class="registro-cliente">
            <h2> Paso 3 de 3: Contacto y Ubicación  </h2>


                <fieldset>

                    <legend> Contacto y Ubicación  </legend>

                    <div class="form-group">
                        <label for="direccion"> Dirección </label>
                        <input type="text" id="direccion" name="direccion" [(ngModel)] ="nuevoCliente.direccion" required>
                    </div>

                    <div class="form-group">
                        <label for="telefono"> Telefono </label>
                        <input type="text" id="telefono" name="telefono" [(ngModel)] ="nuevoCliente.telefono" required>
                    </div>

                </fieldset>

                <div class="actions">
                <button (click)="onSubmit()" class=" btn btn-primary">
                    Registrar
                </button>

            </div>

        </div> }


        @if (paso === 'cargando')
        { <div class="loading-screen">

                <h2> Precesando su Registro </h2>
                <div class="spinner"></div>
                <p>Aplicando validaciones de unicidad y formato. Espere la confirmacion del servidor</p>
        
        </div>}

        @if (paso === 'confirmacion')
        { <div class=" confirmation-card">
            
                <h2>✅ Datos Registrados Correctamente</h2>
        
                <p class="success-message">¡El sistema ha registrado su información! Por favor, confirme los siguientes detalles:</p>
        
                <div class="data-summary">
                    <div class="data-row"><strong>Tipo de Persona:</strong> <span>{{ nuevoCliente.tipoPersona }}</span></div>
                    <div class="data-row"><strong>Cédula:</strong> <span>{{ nuevoCliente.cedula }}</span></div>
                    <div class="data-row"><strong>Nombre:</strong> <span>{{ nuevoCliente.nombre }} {{ clienteConfirmado?.apellido }}</span></div>
                    <div class="data-row"><strong>Email:</strong> <span>{{ nuevoCliente.email }}</span></div>
                    <div class="data-row"><strong>Usuario:</strong> <span>{{ nuevoCliente.usuario }}</span></div>
                    <div class="data-row"><strong>Dirección:</strong> <span>{{ nuevoCliente.direccion }}</span></div>
                    <div class="data-row"><strong>Teléfono:</strong> <span>{{ nuevoCliente.telefono }}</span></div>

                </div>

            <div class="actions">

                <button (click)="modificarDatos()" class="btn btn-secondary">
                    Modificar 
                </button>

                <button (click)="finalizarRegistro()" class="btn btn-primary">
                    Finalizar y Continuar 
                </button>
            </div>

        </div>}

</div>