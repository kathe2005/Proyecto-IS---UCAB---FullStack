<div id="ContenedorMain">
  <div id="contenedor">
    <!-- Header -->
    <div class="header-section">
      <h1 class="titulo-principal">Sistema de Gestión de Estacionamiento</h1>
      <p class="subtitulo">Universidad Católica Andrés Bello - UCAB Montalbán</p>
    </div>

    <!-- Título de la sección -->
    <div class="section-title">
      <h2>Ocupar Puesto de Estacionamiento</h2>
      <p>Seleccione un puesto disponible y busque el cliente por cédula</p>
    </div>

    <!-- Mensajes de resultado -->
    <div *ngIf="mensaje" [class]="'alert alert-' + mensajeTipo" class="alert">
      <i class="fas fa-info-circle"></i> {{ mensaje }}
    </div>

    <!-- Selección de puestos -->
    <div *ngIf="!puestoSeleccionado">
      <div class="card section-card">
        <div class="card-content">
          <div class="icono">
            <i class="fas fa-list"></i>
          </div>
          <div class="texto">
            <h3>Puestos Disponibles</h3>
            <p>Seleccione un puesto de la lista para ocuparlo</p>
          </div>
        </div>
      </div>

      <!-- Grid de puestos disponibles -->
      <div class="puestos-grid">
        <div *ngFor="let puesto of puestosDisponibles"
             class="puesto-card"
             (click)="seleccionarPuesto(puesto)">
          <div class="puesto-header">
            <h5>Puesto {{ puesto.numero }}</h5>
            <span class="badge" [style.background]="getTipoColor(puesto.tipoPuesto)">
              {{ getTipoDescripcion(puesto.tipoPuesto) }}
            </span>
          </div>
          <div class="puesto-info">
            <p><i class="fas fa-map-marker-alt"></i> {{ puesto.ubicacion }}</p>
            <small class="text-muted"><i class="fas fa-hashtag"></i> ID: {{ puesto.id }}</small>
          </div>
        </div>
      </div>

      <!-- Mensaje cuando no hay puestos -->
      <div *ngIf="puestosDisponibles.length === 0 && !procesando" class="card empty-state">
        <div class="empty-content">
          <i class="fas fa-parking text-warning"></i>
          <h3>No hay puestos disponibles</h3>
          <p>Todos los puestos están ocupados en este momento.</p>
        </div>
      </div>

      <!-- Loading state -->
      <div *ngIf="procesando" class="card loading-state">
        <div class="loading-content">
          <i class="fas fa-spinner fa-spin"></i>
          <p>Cargando puestos disponibles...</p>
        </div>
      </div>
    </div>

    <!-- Confirmación de ocupación -->
    <div *ngIf="puestoSeleccionado">
      <!-- Sección de confirmación -->
      <div class="card section-card confirmacion-card">
        <div class="card-content">
          <div class="icono">
            <i class="fas fa-check-circle"></i>
          </div>
          <div class="texto">
            <h3>Confirmar Ocupación</h3>
            <p>Busque el cliente y confirme la ocupación del puesto</p>
          </div>
        </div>
      </div>

      <!-- Información del puesto seleccionado -->
      <div class="card info-card">
        <div class="card-content">
          <h4 class="info-title">Información del Puesto Seleccionado</h4>
          <div class="info-grid">
            <div class="info-item">
              <label><i class="fas fa-hashtag"></i> Número:</label>
              <span class="info-value">{{ puestoSeleccionado.numero }}</span>
            </div>
            <div class="info-item">
              <label><i class="fas fa-map-marker-alt"></i> Ubicación:</label>
              <span class="info-value">{{ puestoSeleccionado.ubicacion }}</span>
            </div>
            <div class="info-item">
              <label><i class="fas fa-tag"></i> Tipo:</label>
              <span class="badge" [style.background]="getTipoColor(puestoSeleccionado.tipoPuesto)">
                {{ getTipoDescripcion(puestoSeleccionado.tipoPuesto) }}
              </span>
            </div>
            <div class="info-item">
              <label><i class="fas fa-fingerprint"></i> ID:</label>
              <span class="info-value">{{ puestoSeleccionado.id }}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Búsqueda de cliente -->
      <div class="card form-card">
        <div class="card-content">
          <h4 class="form-title">Búsqueda del Cliente</h4>
          <form (ngSubmit)="buscarCliente()" class="ocupacion-form">
            <div class="form-group">
              <label class="form-label">
                <i class="fas fa-id-card"></i> Cédula del Cliente
              </label>
              <div class="input-group">
                <input type="text"
                       [(ngModel)]="ocuparRequest.cedula"
                       name="cedula"
                       class="form-control"
                       placeholder="Ingrese la cédula del cliente"
                       required
                       maxlength="20"
                       pattern="[0-9]+"
                       title="Solo se permiten números"
                       [disabled]="buscandoCliente">
                <button type="submit"
                        class="btn btn-primary btn-buscar"
                        [disabled]="buscandoCliente || !ocuparRequest.cedula">
                  <i class="fas fa-search"></i>
                  {{ buscandoCliente ? 'Buscando...' : 'Buscar' }}
                </button>
              </div>
              <small class="form-text">Ingrese solo números (sin puntos ni guiones)</small>
            </div>
          </form>

          <!-- Información del cliente encontrado -->
          <div *ngIf="clienteEncontrado" class="cliente-info-card">
            <h5 class="cliente-title">
              <i class="fas fa-user-check text-success"></i>
              Cliente Encontrado
            </h5>
            <div class="cliente-details">
              <div class="cliente-item">
                <strong>Nombre:</strong> {{ clienteEncontrado.nombre }} {{ clienteEncontrado.apellido }}
              </div>
              <div class="cliente-item">
                <strong>Cédula:</strong> {{ clienteEncontrado.cedula }}
              </div>
              <div class="cliente-item">
                <strong>Email:</strong> {{ clienteEncontrado.email }}
              </div>
              <div class="cliente-item">
                <strong>Teléfono:</strong> {{ clienteEncontrado.telefono }}
              </div>
              <div class="cliente-item">
                <strong>Tipo:</strong>
                <span class="badge" [ngClass]="clienteEncontrado.tipoPersona === 'UCAB' ? 'badge-success' : 'badge-warning'">
                  {{ clienteEncontrado.tipoPersona }}
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Acciones de confirmación -->
      <div class="card form-card" *ngIf="clienteEncontrado">
        <div class="card-content">
          <h4 class="form-title">Confirmar Ocupación</h4>
          <div class="confirmation-section">
            <p>¿Está seguro de que desea asignar este puesto al cliente <strong>{{ clienteEncontrado.nombre }} {{ clienteEncontrado.apellido }}</strong>?</p>
            <div class="form-actions">
              <button type="button" (click)="cancelarSeleccion()" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i> Cancelar
              </button>
              <button type="button" (click)="confirmarOcupacion()" class="btn btn-primary" [disabled]="procesando">
                <i class="fas fa-car"></i>
                {{ procesando ? 'Procesando...' : 'Confirmar Ocupación' }}
            </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="footer">
    © 2025 UCAB Montalbán - Sistema de Estacionamiento
  </footer>
</div>
